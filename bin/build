#!/usr/bin/env ruby

INDENT_CONTENT = ' ' * 4
LAYOUT_FILENAME = 'page_layout.html'
PAGES = {
  'index.html' => 'index.html',
  'about.html' => 'about/index.html',
  'media_gallery.html' => 'media_gallery/index.html',
  'get_involved.html' => 'get_involved/index.html',
  'contact_us.html' => 'contact_us/index.html',
}

layout = File.read("src/#{LAYOUT_FILENAME}")

puts "building"
PAGES.each do |src_filename, dist_filename|
  puts "dist/#{dist_filename}"

  src = File.read("src/#{src_filename}")
  indented_src = src.lines.map do |line|
    line == "\n" ? line : "#{INDENT_CONTENT}#{line}"
  end.join('')

  dist = layout.sub("{{CONTENT}}\n", indented_src)
  File.write("dist/#{dist_filename}", dist)
end
